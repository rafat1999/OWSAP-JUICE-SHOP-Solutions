# Juice-Shop Write-up: Bjoern Login

## Challenge Overview

**Title:** Bjoern Login  
**Category:** Broken Authentication  
**Difficulty:** ⭐⭐⭐⭐ (4/6)

This challenge requires logging into Bjoern's account, one of the creators of Juice Shop, without directly compromising his Google account or engaging in illegal activities.

## Tools Used

- **Web Browser**: To interact with the Juice Shop application.
- **Development Tools**: For testing and validating JavaScript functions.

## Methodology and Solution

### Step 1: Analyzing Application Code

1. **Investigating OAuth Implementation**:
   - The challenge clue suggests examining how OAuth login was previously implemented in the Juice Shop application.
   - By searching keyword and reading the main.js, I was able to identify that the function `ngOnInit()` in the application's main JavaScript file handles OAuth logins.

### Step 2: Extracting Bjoern's Email

2. **Reverse Engineering the Password Creation**:
   - Inside `ngOnInit()`, the password is generated through a specific process using the user's email. The process involves:
     - Splitting the email string into an array of characters.
     - Reversing the array.
     - Joining the array back into a string.
     - Encoding the resultant string in Base64 format using `btoa()`.

3. **Formula Breakdown**:
   - `const i = btoa(o.email.split("").reverse().join(""));` where `o.email` is the user's email.
   - The password is effectively a reversible transformation of the email address, creating a unique yet predictable password for each user based on their email.

### Step 3: Calculating Bjoern's Password

4. **Application of Reverse Engineered Formula**:
   - Given Bjoern's email, `bjoern.kimmich@gmail.com`, the password is generated by reversing the email and encoding it in Base64:
     ```
     var email = "bjoern.kimmich@gmail.com";
     var reversed = email.split("").reverse().join("");
     var password = btoa(reversed);
     ```
   - This process was simulated in a JavaScript console to produce the exact password string.

### Step 4: Logging into Bjoern's Account

5. **Using the Derived Password**:
   - With the calculated password, access Bjoern's account by entering the email and the derived password on the Juice Shop login page.

## Solution Explanation

The challenge was solved by exploiting a flaw in the Juice Shop's OAuth user registration system, which created predictable passwords based on users' email addresses. By reverse-engineering this process, it was possible to compute Bjoern's password and gain access to his account.

### Security Recommendations

- **Secure Password Generation**: Avoid using predictable algorithms for password generation, and most importantly, don't use them client side. Use strong, random, and non-reversible methods.
